FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHZpcnR1YWxtYWNoaW5lLWFwYgpkZXNjcmlwdGlvbjogQVBCIGZv\
ciBtYW5hZ2luZyBWaXJ0dWFsIE1hY2hpbmUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25h\
bAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogVmlydHVhbCBNYWNoaW5lIChBUEIpCiAgaW1hZ2VV\
cmw6IGh0dHBzOi8vY2RuLnBicmQuY28vaW1hZ2VzL0g1R3V0ZDcucG5nCnBsYW5zOgogIC0gbmFt\
ZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFZpcnR1YWwgbWFjaGluZSBjcmVhdGVkIGZyb20g\
Y3VzdG9tIFlBTUwKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFt\
ZTogQ3VzdG9tIFlBTUwKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBWaXJ0dWFsIG1hY2hpbmUgY3Jl\
YXRlZCBmcm9tIGN1c3RvbSBZQU1MCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGFkbWlu\
X3VzZXIKICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFVzZXIKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGFkbWluX3Bhc3N3b3Jk\
CiAgICAgICAgdGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBQYXNzd29yZAogICAgICAgIHR5cGU6IHBh\
c3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBjdXN0b21feWFtbAog\
ICAgICAgIHRpdGxlOiBDdXN0b20gY29uZmlndXJhdGlvbiAoWUFNTCkKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKCiAgLSBuYW1lOiBsaW51eAogICAgZGVzY3JpcHRpb246IExpbnV4IFZpcnR1YWwgTWFjaGlu\
ZSBEZXBsb3ltZW50CiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5h\
bWU6IExpbnV4IFZpcnR1YWwgTWFjaGluZQogICAgICBsb25nRGVzY3JpcHRpb246IFZpcnR1YWwg\
bWFjaGluZSB3aXRoIHByZS1pbnN0YWxsZWQgTGludXgKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0g\
bmFtZTogYWRtaW5fdXNlcgogICAgICAgIHRpdGxlOiBPcGVuc2hpZnQgQWRtaW4gVXNlcgogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogYWRt\
aW5fcGFzc3dvcmQKICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFBhc3N3b3JkCiAgICAg\
ICAgdHlwZTogcGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHZt\
bmFtZQogICAgICAgIHRpdGxlOiBOYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlz\
cGxheV90eXBlOiB0ZXh0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiB2bW1l\
bW9yeQogICAgICAgIHRpdGxlOiBNZW1vcnkgKGluIE1pQikKICAgICAgICB0eXBlOiBlbnVtCiAg\
ICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBlbnVtOiBbMzIsIDY0LCA1MTIsIDEwMjQsIDIw\
NDhdCiAgICAgICAgZGVmYXVsdDogNjQKICAgICAgLSBuYW1lOiB2bWRpc2tpbWFnZQogICAgICAg\
IGRlZmF1bHQ6ICdmZWRvcmEtY2xvdWQnCiAgICAgICAgdGl0bGU6IERpc2sgSW1hZ2UKICAgICAg\
ICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWydhbHBpbmUnLCAnY2lycm9zJywgJ2ZlZG9yYS1j\
bG91ZCddCiAgICAgICAgZGlzcGxheV90eXBlOiBzZWxlY3QK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
